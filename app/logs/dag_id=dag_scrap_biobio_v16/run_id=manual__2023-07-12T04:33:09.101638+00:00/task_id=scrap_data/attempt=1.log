[2023-07-12T04:33:11.014+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dag_scrap_biobio_v16.scrap_data manual__2023-07-12T04:33:09.101638+00:00 [queued]>
[2023-07-12T04:33:11.022+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dag_scrap_biobio_v16.scrap_data manual__2023-07-12T04:33:09.101638+00:00 [queued]>
[2023-07-12T04:33:11.022+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 1
[2023-07-12T04:33:11.034+0000] {taskinstance.py:1327} INFO - Executing <Task(_PythonVirtualenvDecoratedOperator): scrap_data> on 2023-07-12 04:33:09.101638+00:00
[2023-07-12T04:33:11.040+0000] {standard_task_runner.py:57} INFO - Started process 286 to run task
[2023-07-12T04:33:11.042+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'dag_scrap_biobio_v16', 'scrap_data', 'manual__2023-07-12T04:33:09.101638+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/dag_scrap_biobio.py', '--cfg-path', '/tmp/tmpbxkvn3vo']
[2023-07-12T04:33:11.043+0000] {standard_task_runner.py:85} INFO - Job 9: Subtask scrap_data
[2023-07-12T04:33:11.077+0000] {task_command.py:410} INFO - Running <TaskInstance: dag_scrap_biobio_v16.scrap_data manual__2023-07-12T04:33:09.101638+00:00 [running]> on host 9f0cb576b5b8
[2023-07-12T04:33:11.162+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='dag_scrap_biobio_v16' AIRFLOW_CTX_TASK_ID='scrap_data' AIRFLOW_CTX_EXECUTION_DATE='2023-07-12T04:33:09.101638+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-07-12T04:33:09.101638+00:00'
[2023-07-12T04:33:11.163+0000] {process_utils.py:181} INFO - Executing cmd: /usr/local/bin/python -m virtualenv /tmp/venvun1yws6r --system-site-packages --python=python3.9
[2023-07-12T04:33:11.183+0000] {process_utils.py:185} INFO - Output:
[2023-07-12T04:33:12.311+0000] {process_utils.py:189} INFO - created virtual environment CPython3.9.2.final.0-64 in 446ms
[2023-07-12T04:33:12.311+0000] {process_utils.py:189} INFO -   creator CPython3Posix(dest=/tmp/venvun1yws6r, clear=False, no_vcs_ignore=False, global=True)
[2023-07-12T04:33:12.311+0000] {process_utils.py:189} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/***/.local/share/virtualenv)
[2023-07-12T04:33:12.311+0000] {process_utils.py:189} INFO -     added seed packages: pip==23.1, setuptools==67.6.1, wheel==0.40.0
[2023-07-12T04:33:12.312+0000] {process_utils.py:189} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2023-07-12T04:33:12.362+0000] {process_utils.py:181} INFO - Executing cmd: /tmp/venvun1yws6r/bin/pip install -r /tmp/venvun1yws6r/requirements.txt
[2023-07-12T04:33:12.373+0000] {process_utils.py:185} INFO - Output:
[2023-07-12T04:33:13.175+0000] {process_utils.py:189} INFO - Collecting selenium (from -r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:13.205+0000] {process_utils.py:189} INFO -   Using cached selenium-4.10.0-py3-none-any.whl (6.7 MB)
[2023-07-12T04:33:13.255+0000] {process_utils.py:189} INFO - Collecting pyspark (from -r /tmp/venvun1yws6r/requirements.txt (line 2))
[2023-07-12T04:33:13.256+0000] {process_utils.py:189} INFO -   Using cached pyspark-3.4.1-py2.py3-none-any.whl
[2023-07-12T04:33:13.302+0000] {process_utils.py:189} INFO - Collecting dateparser (from -r /tmp/venvun1yws6r/requirements.txt (line 3))
[2023-07-12T04:33:13.304+0000] {process_utils.py:189} INFO -   Using cached dateparser-1.1.8-py2.py3-none-any.whl (293 kB)
[2023-07-12T04:33:13.381+0000] {process_utils.py:189} INFO - Collecting urllib3[socks]<3,>=1.26 (from selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:13.383+0000] {process_utils.py:189} INFO -   Using cached urllib3-2.0.3-py3-none-any.whl (123 kB)
[2023-07-12T04:33:13.430+0000] {process_utils.py:189} INFO - Collecting trio~=0.17 (from selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:13.433+0000] {process_utils.py:189} INFO -   Using cached trio-0.22.1-py3-none-any.whl (399 kB)
[2023-07-12T04:33:13.484+0000] {process_utils.py:189} INFO - Collecting trio-websocket~=0.9 (from selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:13.486+0000] {process_utils.py:189} INFO -   Using cached trio_websocket-0.10.3-py3-none-any.whl (17 kB)
[2023-07-12T04:33:13.529+0000] {process_utils.py:189} INFO - Collecting certifi>=2021.10.8 (from selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:13.530+0000] {process_utils.py:189} INFO -   Using cached certifi-2023.5.7-py3-none-any.whl (156 kB)
[2023-07-12T04:33:13.601+0000] {process_utils.py:189} INFO - Collecting py4j==0.10.9.7 (from pyspark->-r /tmp/venvun1yws6r/requirements.txt (line 2))
[2023-07-12T04:33:13.603+0000] {process_utils.py:189} INFO -   Using cached py4j-0.10.9.7-py2.py3-none-any.whl (200 kB)
[2023-07-12T04:33:13.658+0000] {process_utils.py:189} INFO - Collecting python-dateutil (from dateparser->-r /tmp/venvun1yws6r/requirements.txt (line 3))
[2023-07-12T04:33:13.661+0000] {process_utils.py:189} INFO -   Using cached python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)
[2023-07-12T04:33:13.737+0000] {process_utils.py:189} INFO - Collecting pytz (from dateparser->-r /tmp/venvun1yws6r/requirements.txt (line 3))
[2023-07-12T04:33:13.740+0000] {process_utils.py:189} INFO -   Using cached pytz-2023.3-py2.py3-none-any.whl (502 kB)
[2023-07-12T04:33:14.329+0000] {process_utils.py:189} INFO - Collecting regex!=2019.02.19,!=2021.8.27 (from dateparser->-r /tmp/venvun1yws6r/requirements.txt (line 3))
[2023-07-12T04:33:14.336+0000] {process_utils.py:189} INFO -   Using cached regex-2023.6.3-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (769 kB)
[2023-07-12T04:33:14.379+0000] {process_utils.py:189} INFO - Collecting tzlocal (from dateparser->-r /tmp/venvun1yws6r/requirements.txt (line 3))
[2023-07-12T04:33:14.381+0000] {process_utils.py:189} INFO -   Using cached tzlocal-5.0.1-py3-none-any.whl (20 kB)
[2023-07-12T04:33:14.428+0000] {process_utils.py:189} INFO - Collecting attrs>=20.1.0 (from trio~=0.17->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.429+0000] {process_utils.py:189} INFO -   Using cached attrs-23.1.0-py3-none-any.whl (61 kB)
[2023-07-12T04:33:14.469+0000] {process_utils.py:189} INFO - Collecting sortedcontainers (from trio~=0.17->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.471+0000] {process_utils.py:189} INFO -   Using cached sortedcontainers-2.4.0-py2.py3-none-any.whl (29 kB)
[2023-07-12T04:33:14.511+0000] {process_utils.py:189} INFO - Collecting idna (from trio~=0.17->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.513+0000] {process_utils.py:189} INFO -   Using cached idna-3.4-py3-none-any.whl (61 kB)
[2023-07-12T04:33:14.560+0000] {process_utils.py:189} INFO - Collecting outcome (from trio~=0.17->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.563+0000] {process_utils.py:189} INFO -   Using cached outcome-1.2.0-py2.py3-none-any.whl (9.7 kB)
[2023-07-12T04:33:14.747+0000] {process_utils.py:189} INFO - Collecting sniffio (from trio~=0.17->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.749+0000] {process_utils.py:189} INFO -   Using cached sniffio-1.3.0-py3-none-any.whl (10 kB)
[2023-07-12T04:33:14.786+0000] {process_utils.py:189} INFO - Collecting exceptiongroup>=1.0.0rc9 (from trio~=0.17->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.787+0000] {process_utils.py:189} INFO -   Using cached exceptiongroup-1.1.2-py3-none-any.whl (14 kB)
[2023-07-12T04:33:14.836+0000] {process_utils.py:189} INFO - Collecting wsproto>=0.14 (from trio-websocket~=0.9->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.838+0000] {process_utils.py:189} INFO -   Using cached wsproto-1.2.0-py3-none-any.whl (24 kB)
[2023-07-12T04:33:14.893+0000] {process_utils.py:189} INFO - Collecting pysocks!=1.5.7,<2.0,>=1.5.6 (from urllib3[socks]<3,>=1.26->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:14.894+0000] {process_utils.py:189} INFO -   Using cached PySocks-1.7.1-py3-none-any.whl (16 kB)
[2023-07-12T04:33:14.935+0000] {process_utils.py:189} INFO - Collecting six>=1.5 (from python-dateutil->dateparser->-r /tmp/venvun1yws6r/requirements.txt (line 3))
[2023-07-12T04:33:14.936+0000] {process_utils.py:189} INFO -   Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)
[2023-07-12T04:33:15.010+0000] {process_utils.py:189} INFO - Collecting h11<1,>=0.9.0 (from wsproto>=0.14->trio-websocket~=0.9->selenium->-r /tmp/venvun1yws6r/requirements.txt (line 1))
[2023-07-12T04:33:15.012+0000] {process_utils.py:189} INFO -   Using cached h11-0.14.0-py3-none-any.whl (58 kB)
[2023-07-12T04:33:15.130+0000] {process_utils.py:189} INFO - Installing collected packages: sortedcontainers, pytz, py4j, urllib3, tzlocal, sniffio, six, regex, pyspark, pysocks, idna, h11, exceptiongroup, certifi, attrs, wsproto, python-dateutil, outcome, trio, dateparser, trio-websocket, selenium
[2023-07-12T04:33:19.455+0000] {process_utils.py:189} INFO - Successfully installed attrs-23.1.0 certifi-2023.5.7 dateparser-1.1.8 exceptiongroup-1.1.2 h11-0.14.0 idna-3.4 outcome-1.2.0 py4j-0.10.9.7 pysocks-1.7.1 pyspark-3.4.1 python-dateutil-2.8.2 pytz-2023.3 regex-2023.6.3 selenium-4.10.0 six-1.16.0 sniffio-1.3.0 sortedcontainers-2.4.0 trio-0.22.1 trio-websocket-0.10.3 tzlocal-5.0.1 urllib3-2.0.3 wsproto-1.2.0
[2023-07-12T04:33:19.608+0000] {process_utils.py:189} INFO - 
[2023-07-12T04:33:19.609+0000] {process_utils.py:189} INFO - [notice] A new release of pip is available: 23.1 -> 23.1.2
[2023-07-12T04:33:19.609+0000] {process_utils.py:189} INFO - [notice] To update, run: /tmp/venvun1yws6r/bin/python -m pip install --upgrade pip
[2023-07-12T04:33:19.721+0000] {process_utils.py:181} INFO - Executing cmd: /tmp/venvun1yws6r/bin/python /tmp/venvun1yws6r/script.py /tmp/venvun1yws6r/script.in /tmp/venvun1yws6r/script.out /tmp/venvun1yws6r/string_args.txt
[2023-07-12T04:33:19.730+0000] {process_utils.py:185} INFO - Output:
[2023-07-12T04:33:20.061+0000] {process_utils.py:189} INFO - Traceback (most recent call last):
[2023-07-12T04:33:20.061+0000] {process_utils.py:189} INFO -   File "/tmp/venvun1yws6r/script.py", line 163, in <module>
[2023-07-12T04:33:20.061+0000] {process_utils.py:189} INFO -     res = scrapData(*arg_dict["args"], **arg_dict["kwargs"])
[2023-07-12T04:33:20.062+0000] {process_utils.py:189} INFO -   File "/tmp/venvun1yws6r/script.py", line 44, in scrapData
[2023-07-12T04:33:20.062+0000] {process_utils.py:189} INFO -     spark = SparkSession.builder \
[2023-07-12T04:33:20.062+0000] {process_utils.py:189} INFO -   File "/tmp/venvun1yws6r/lib/python3.9/site-packages/pyspark/sql/session.py", line 477, in getOrCreate
[2023-07-12T04:33:20.062+0000] {process_utils.py:189} INFO -     sc = SparkContext.getOrCreate(sparkConf)
[2023-07-12T04:33:20.062+0000] {process_utils.py:189} INFO -   File "/tmp/venvun1yws6r/lib/python3.9/site-packages/pyspark/context.py", line 512, in getOrCreate
[2023-07-12T04:33:20.062+0000] {process_utils.py:189} INFO -     SparkContext(conf=conf or SparkConf())
[2023-07-12T04:33:20.063+0000] {process_utils.py:189} INFO -   File "/tmp/venvun1yws6r/lib/python3.9/site-packages/pyspark/context.py", line 198, in __init__
[2023-07-12T04:33:20.063+0000] {process_utils.py:189} INFO -     SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)
[2023-07-12T04:33:20.063+0000] {process_utils.py:189} INFO -   File "/tmp/venvun1yws6r/lib/python3.9/site-packages/pyspark/context.py", line 432, in _ensure_initialized
[2023-07-12T04:33:20.063+0000] {process_utils.py:189} INFO -     SparkContext._gateway = gateway or launch_gateway(conf)
[2023-07-12T04:33:20.063+0000] {process_utils.py:189} INFO -   File "/tmp/venvun1yws6r/lib/python3.9/site-packages/pyspark/java_gateway.py", line 96, in launch_gateway
[2023-07-12T04:33:20.064+0000] {process_utils.py:189} INFO -     proc = Popen(command, **popen_kwargs)
[2023-07-12T04:33:20.064+0000] {process_utils.py:189} INFO -   File "/usr/lib/python3.9/subprocess.py", line 951, in __init__
[2023-07-12T04:33:20.064+0000] {process_utils.py:189} INFO -     self._execute_child(args, executable, preexec_fn, close_fds,
[2023-07-12T04:33:20.064+0000] {process_utils.py:189} INFO -   File "/usr/lib/python3.9/subprocess.py", line 1823, in _execute_child
[2023-07-12T04:33:20.064+0000] {process_utils.py:189} INFO -     raise child_exception_type(errno_num, err_msg, err_filename)
[2023-07-12T04:33:20.065+0000] {process_utils.py:189} INFO - NotADirectoryError: [Errno 20] Not a directory: '/opt/spark/./bin/spark-submit'
[2023-07-12T04:33:20.232+0000] {taskinstance.py:1824} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/decorators/base.py", line 220, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 374, in execute
    return super().execute(context=serializable_context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 578, in execute_callable
    result = self._execute_python_callable_in_subprocess(python_path, tmp_path)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 434, in _execute_python_callable_in_subprocess
    os.fspath(string_args_path),
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/process_utils.py", line 170, in execute_in_subprocess
    execute_in_subprocess_with_kwargs(cmd, cwd=cwd)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/process_utils.py", line 193, in execute_in_subprocess_with_kwargs
    raise subprocess.CalledProcessError(exit_code, cmd)
subprocess.CalledProcessError: Command '['/tmp/venvun1yws6r/bin/python', '/tmp/venvun1yws6r/script.py', '/tmp/venvun1yws6r/script.in', '/tmp/venvun1yws6r/script.out', '/tmp/venvun1yws6r/string_args.txt']' returned non-zero exit status 1.
[2023-07-12T04:33:20.244+0000] {taskinstance.py:1350} INFO - Marking task as FAILED. dag_id=dag_scrap_biobio_v16, task_id=scrap_data, execution_date=20230712T043309, start_date=20230712T043311, end_date=20230712T043320
[2023-07-12T04:33:20.261+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 9 for task scrap_data (Command '['/tmp/venvun1yws6r/bin/python', '/tmp/venvun1yws6r/script.py', '/tmp/venvun1yws6r/script.in', '/tmp/venvun1yws6r/script.out', '/tmp/venvun1yws6r/string_args.txt']' returned non-zero exit status 1.; 286)
[2023-07-12T04:33:20.298+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 1
[2023-07-12T04:33:20.314+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check
